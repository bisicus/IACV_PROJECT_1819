% Per adesso i punti della linea sono hardcodati, ma serve un metodo per
% riuscire a farli con hough

P = [...
     321, 541, 1; ...
     381, 543, 1; ...
     562, 549, 1; ...
     644, 552, 1; ...
     648, 552, 1; ...
     700, 554, 1; ...
     944, 561, 1; ...
     971, 562, 1; ...
    1000, 563, 1; ...
    1025, 564, 1; ...
    1083, 565, 1; ...
    1135, 567, 1; ...
    1189, 568, 1; ...
    1272, 571, 1; ...
    1413, 574, 1; ...
    1467, 575, 1; ...
    1604, 579, 1; ...
    1661, 581, 1; ...
    1799, 584, 1; ...
    1806, 584, 1  ...
];

%% Intersecting all points

k = ( length(P)-1 * (length(P)) ) /2;
L = zeros(k, 3);

kk = 1;
for ii = 1:length(P) - 1
   for jj = ii+1 : length(P)
       
       l = cross(P(ii,:), P(jj,:)); %must be row vector
       L(kk, :) = l;
       
       kk = kk+1;
   end
end


%% Averaging to obtain the actual line
horiz_BlackKey_line = mean(L, 1);

front_geometric_features.horiz_BlackKey_line = ...
            horiz_BlackKey_line / horiz_BlackKey_line(3);

%% Plotting
if show_figures == 1
   
   figure(1006); imshow(front_video.WhiteKeys_Mask); hold on
   title( 'Black Keys finishing Line' )

   plot_homog_line(horiz_BlackKey_line, [1,1920])
   scatter(P(:,1), P(:,2), 40, 'cyan', 'o', 'filled')

end
%% Clean Workspace

clear ii jj kk k
clear l L P
clear horiz_BlackKey_line